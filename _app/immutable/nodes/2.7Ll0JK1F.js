var M=Object.defineProperty;var P=(t,e,n)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var k=(t,e,n)=>P(t,typeof e!="symbol"?e+"":e,n);import"../chunks/Bzak7iHL.js";import{a8 as v,h as I,A as G,E as w,aB as H,c as S,f as T,s as C,a as B,aC as j,B as F,F as O,G as N,C as q,aD as V,aA as z,H as x}from"../chunks/CV9U0wfe.js";import{o as U,e as K,d as J}from"../chunks/JYJuTims.js";import{p as u}from"../chunks/BQvUQ1wV.js";import{i as L}from"../chunks/DW87uL3V.js";function Q(t,e,n){var a=t==null?"":""+t;return a===""?null:a}function R(t,e){return t==null?null:String(t)}function W(t,e,n,a,m,d){var i=t.__className;if(v||i!==n||i===void 0){var s=Q(n);(!v||s!==t.getAttribute("class"))&&(s==null?t.removeAttribute("class"):t.className=s),t.__className=n}return d}function X(t,e,n,a){var m=t.__style;if(v||m!==e){var d=R(e);(!v||d!==t.getAttribute("style"))&&(d==null?t.removeAttribute("style"):t.style.cssText=d),t.__style=e}return a}function D(t,e){return t.gamepad===-1||t.gamepad===e.index}class Y{constructor(e){k(this,"focussed",!0);k(this,"input");this.input=e}thisGamepadButton(e,n){return D(this.input,e)}onbuttonpressed(e,n){return!1}onbuttonrelease(e,n){}onbuttonhold(e,n){}onupdate(e){}}class Z{constructor(e){k(this,"focussed",!0);k(this,"input");this.input=e}thisKey(e){return!1}onkeypressed(e){return!1}onkeyrelease(e){}onkeyhold(e){}}const f=I({keyboard:{},gamepad:{}}),$=(t,e,n)=>{t.forEach(a=>{f.keyboard[a]||(f.keyboard[a]=[]),f.keyboard[a].push(e),f.gamepad[a]||(f.gamepad[a]=[]),f.gamepad[a].push(n)})},ee=(t,e,n)=>{t.forEach(a=>{f.keyboard[a]&&f.keyboard[a].splice(f.keyboard[a].indexOf(e),1),f.gamepad[a]&&f.gamepad[a].splice(f.gamepad[a].indexOf(n),1)})};function te(t,e){G(e,!0);let n=u(e,"updateUsingAnimationFrame",3,!1),a=u(e,"updateUsingInterval",3,!0),m=u(e,"timeout",3,1e3/25),d=u(e,"context",3,"default"),i={},s;function g(b){s=b.target.navigator}function p(){let b=f.gamepad[d()];if(s){for(let l of s.getGamepads())if(l){for(let o=0;o<l.buttons.length;o++){if(l.buttons[o].pressed&&(b.forEach(r=>{r.thisGamepadButton(l,o)&&r.onbuttonhold(l,o)}),!i[o])){i[o]=!0;for(let r of b)if(r.thisGamepadButton(l,o)&&r.onbuttonpressed(l,o)===!0)break}i[o]&&!l.buttons[o].pressed&&(i[o]=!1,b.forEach(r=>{r.thisGamepadButton(l,o)&&r.onbuttonrelease(l,o)}))}b.forEach(o=>{D(o.input,l)&&o.onupdate(l)})}}}function h(){p(),requestAnimationFrame(h)}return U(()=>{n()?h():a()&&setInterval(p,m())}),K("gamepadconnected",H,g),w({updateGamepadValues:p})}function ne(t,e){G(e,!1);let n={},a="default",m=s=>{let g=f.keyboard[a];for(let p of g)if(p.thisKey(s)&&p.onkeypressed(s)===!0)break},d=s=>{n[s.key]||m(s);let g=f.keyboard[a];n[s.key]=!0,g.forEach(p=>{p.thisKey(s)&&p.onkeyhold(s)})},i=s=>{delete n[s.key],f.keyboard[a].forEach(p=>{p.thisKey(s)&&p.onkeyrelease(s)})};L(),K("keydown",H,d),K("keyup",H,i),w()}const E=I({buttons:[],joysticks:[],lists:[],sliders:[]});function ae(t,e){G(e,!0);let n=u(e,"disabled",3,!1),a=u(e,"onpressed",3,void 0),m=u(e,"onhold",3,void 0),d=u(e,"onrelease",3,void 0),i=u(e,"pressed",15,!1),s=u(e,"input_mapping",19,()=>({name:"",gamepad:-1,buttons:[0],keys:["e"," "]})),g=u(e,"context",19,()=>["default"]);const p=()=>{n()||(i(!0),a()&&a()())},h=()=>{!n()&&m()&&m()()},b=()=>{i(!1),d()&&d()()};class l extends Z{thisKey(c){return this.input.keys.indexOf(c.key)>-1}onkeypressed(c){return p(),super.onkeypressed(c)}onkeyhold(c){h()}onkeyrelease(c){b()}}class o extends Y{thisGamepadButton(c,y){return super.thisGamepadButton(c,y)&&this.input.buttons.indexOf(y)>-1}onbuttonpressed(c,y){return p(),super.onbuttonpressed(c,y)}onbuttonhold(c,y){h()}onbuttonrelease(c,y){b()}}U(()=>{const _=new l(s()),c=new o(s());return $(g(),_,c),E.buttons.push(s()),()=>{E.buttons.splice(E.buttons.indexOf(s()),1),ee(g(),_,c)}});var r=S(),A=T(r);C(A,()=>e.children??j),B(t,r),w()}var se=(t,e,n)=>{e(),setTimeout(()=>{n()},50)},oe=F("<button><!></button>");function re(t,e){G(e,!0);let n=u(e,"disabled",3,!1),a=u(e,"onpressed",3,void 0),m=u(e,"onhold",3,void 0),d=u(e,"onrelease",3,void 0),i=u(e,"pressed",7,!1),s=u(e,"style",3,""),g=u(e,"cssclass",3,"vbutton"),p=u(e,"input_mapping",19,()=>({name:"",gamepad:-1,buttons:[0],keys:["e"," "]}));const h=()=>{n()||(i(!0),a()&&a()())},b=()=>{i(!1),d()&&d()()};ae(t,{get disabled(){return n()},get onpressed(){return a()},get onhold(){return m()},get onrelease(){return d()},get input_mapping(){return p()},get pressed(){return i()},set pressed(l){i(l)},children:(l,o)=>{var r=oe();r.__pointerdown=h,r.__click=[se,h,b],r.__pointerup=b;var A=O(r);C(A,()=>e.children),N(r),q(()=>{X(r,s()),W(r,1,(!n()&&i()?"button_clicked ":"")+g())}),B(l,r)},$$slots:{default:!0}}),w()}J(["pointerdown","click","pointerup"]);var ie=F("<main><!> <!> <!></main>");function me(t){I([0,0]);var e=ie(),n=O(e);re(n,{input_mapping:{name:"Side Nav",gamepad:-1,buttons:[1],keys:["e"]},children:(d,i)=>{V();var s=z("press me!");B(d,s)},$$slots:{default:!0}});var a=x(n,2);te(a,{});var m=x(a,2);ne(m,{}),N(e),B(t,e)}export{me as component};
