var M=Object.defineProperty;var P=(t,e,n)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var k=(t,e,n)=>P(t,typeof e!="symbol"?e+"":e,n);import"../chunks/Bzak7iHL.js";import{a8 as v,h as I,A as G,E as w,aB as H,c as S,f as T,s as F,a as B,aC as j,B as O,F as N,G as U,C as q,aD as V,aA as z,H as x}from"../chunks/CV9U0wfe.js";import{o as C,e as K,d as J}from"../chunks/JYJuTims.js";import{p as d}from"../chunks/BQvUQ1wV.js";import{i as L}from"../chunks/DW87uL3V.js";function Q(t,e,n){var s=t==null?"":""+t;return s===""?null:s}function R(t,e){return t==null?null:String(t)}function W(t,e,n,s,b,l){var u=t.__className;if(v||u!==n||u===void 0){var a=Q(n);(!v||a!==t.getAttribute("class"))&&(a==null?t.removeAttribute("class"):t.className=a),t.__className=n}return l}function X(t,e,n,s){var b=t.__style;if(v||b!==e){var l=R(e);(!v||l!==t.getAttribute("style"))&&(l==null?t.removeAttribute("style"):t.style.cssText=l),t.__style=e}return s}function D(t,e){return t.gamepad===-1||t.gamepad===e.index}class Y{constructor(e){k(this,"focussed",!0);k(this,"input");this.input=e}thisKey(e){return!1}onkeypressed(e){return!1}onkeyrelease(e){}onkeyhold(e){}}const c=I({keyboard:{},gamepad:{}});function Z(t,e){G(e,!0);let n=d(e,"updateUsingAnimationFrame",3,!1),s=d(e,"updateUsingInterval",3,!0),b=d(e,"timeout",3,1e3/25),l=d(e,"context",3,"default"),u={},a;function g(h){a=h.target.navigator}function f(){let h=c.gamepad[l()];if(a){for(let p of a.getGamepads())if(p){for(let o=0;o<p.buttons.length;o++){if(p.buttons[o].pressed&&(h.forEach(r=>{r.thisGamepadButton(p,o)&&r.onbuttonhold(p,o)}),!u[o])){u[o]=!0;for(let r of h)if(r.thisGamepadButton(p,o)&&r.onbuttonpressed(p,o)===!0)break}u[o]&&!p.buttons[o].pressed&&(u[o]=!1,h.forEach(r=>{r.thisGamepadButton(p,o)&&r.onbuttonrelease(p,o)}))}h.forEach(o=>{D(o.input,p)&&o.onupdate(p)})}}}function y(){f(),requestAnimationFrame(y)}return C(()=>{n()?y():s()&&setInterval(f,b())}),K("gamepadconnected",H,g),w({updateGamepadValues:f})}function $(t,e){G(e,!1);let n={},s="default",b=a=>{let g=c.keyboard[s];for(let f of g)if(f.thisKey(a)&&f.onkeypressed(a)===!0)break},l=a=>{n[a.key]||b(a);let g=c.keyboard[s];n[a.key]=!0,g.forEach(f=>{f.thisKey(a)&&f.onkeyhold(a)})},u=a=>{delete n[a.key],c.keyboard[s].forEach(f=>{f.thisKey(a)&&f.onkeyrelease(a)})};L(),K("keydown",H,l),K("keyup",H,u),w()}const E=I({buttons:[],joysticks:[],lists:[],sliders:[]});class ee{constructor(e){k(this,"focussed",!0);k(this,"input");this.input=e}thisGamepadButton(e,n){return D(this.input,e)}onbuttonpressed(e,n){return!1}onbuttonrelease(e,n){}onbuttonhold(e,n){}onupdate(e){}}function te(t,e){G(e,!0);let n=d(e,"disabled",3,!1),s=d(e,"onpressed",3,void 0),b=d(e,"onhold",3,void 0),l=d(e,"onrelease",3,void 0),u=d(e,"pressed",15,!1),a=d(e,"input_mapping",19,()=>({name:"",gamepad:-1,buttons:[0],keys:["e"," "]})),g=d(e,"context",19,()=>["default"]);const f=()=>{n()||(u(!0),s()&&s()())},y=()=>{!n()&&b()&&b()()},h=()=>{u(!1),l()&&l()()};class p extends Y{thisKey(m){return this.input.keys.indexOf(m.key)>-1}onkeypressed(m){return f(),super.onkeypressed(m)}onkeyhold(m){y()}onkeyrelease(m){h()}}class o extends ee{thisGamepadButton(m,i){return super.thisGamepadButton(m,i)&&this.input.buttons.indexOf(i)>-1}onbuttonpressed(m,i){return f(),super.onbuttonpressed(m,i)}onbuttonhold(m,i){y()}onbuttonrelease(m,i){h()}}C(()=>{const _=new p(a()),m=new o(a());return g().forEach(i=>{c.keyboard[i]||(c.keyboard[i]=[]),c.keyboard[i].push(_),c.gamepad[i]||(c.gamepad[i]=[]),c.gamepad[i].push(m)}),E.buttons.push(a()),()=>{E.buttons.splice(E.buttons.indexOf(a()),1),g().forEach(i=>{c.keyboard[i]&&c.keyboard[i].splice(c.keyboard[i].indexOf(_),1),c.gamepad[i]&&c.gamepad[i].splice(c.gamepad[i].indexOf(m),1)})}});var r=S(),A=T(r);F(A,()=>e.children??j),B(t,r),w()}var ne=(t,e,n)=>{e(),setTimeout(()=>{n()},50)},ae=O("<button><!></button>");function se(t,e){G(e,!0);let n=d(e,"disabled",3,!1),s=d(e,"onpressed",3,void 0),b=d(e,"onhold",3,void 0),l=d(e,"onrelease",3,void 0),u=d(e,"pressed",7,!1),a=d(e,"style",3,""),g=d(e,"cssclass",3,"vbutton"),f=d(e,"input_mapping",19,()=>({name:"",gamepad:-1,buttons:[0],keys:["e"," "]}));const y=()=>{n()||(u(!0),s()&&s()())},h=()=>{u(!1),l()&&l()()};te(t,{get disabled(){return n()},get onpressed(){return s()},get onhold(){return b()},get onrelease(){return l()},get input_mapping(){return f()},get pressed(){return u()},set pressed(p){u(p)},children:(p,o)=>{var r=ae();r.__pointerdown=y,r.__click=[ne,y,h],r.__pointerup=h;var A=N(r);F(A,()=>e.children),U(r),q(()=>{X(r,a()),W(r,1,(!n()&&u()?"button_clicked ":"")+g())}),B(p,r)},$$slots:{default:!0}}),w()}J(["pointerdown","click","pointerup"]);var oe=O("<main><!> <!> <!></main>");function fe(t){I([0,0]);var e=oe(),n=N(e);se(n,{input_mapping:{name:"Side Nav",gamepad:-1,buttons:[1],keys:["e"]},children:(l,u)=>{V();var a=z("press me!");B(l,a)},$$slots:{default:!0}});var s=x(n,2);Z(s,{});var b=x(s,2);$(b,{}),U(e),B(t,e)}export{fe as component};
